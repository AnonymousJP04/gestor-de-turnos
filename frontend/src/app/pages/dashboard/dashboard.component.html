<div class="container mt-4">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>
      {{ esAdmin ? 'Panel de Administraci贸n' : 'Mis Turnos' }}
    </h2>
  </div>
  <!-- Bot贸n para ir a Administrar Horarios (Solo Admin) -->

  <!-- Secci贸n de Turnos -->
  <div class="card shadow-sm mb-4">
    <div class="card-header">
      <h5 class="mb-0">{{ esAdmin ? 'Todos los Turnos' : 'Pr贸ximos Turnos' }}</h5>
    </div>
    <div class="card-body">
      <div *ngIf="turnos.length === 0" class="alert alert-info">
        No hay turnos registrados
      </div>
      <div *ngIf="turnos.length > 0" class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Hora</th>
              <th>Motivo</th>
              <th *ngIf="esAdmin">Usuario</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let turno of turnos; trackBy: trackByTurnoId">
              <td>{{ turno.fecha | date:'dd/MM/yyyy' }}</td>
              <td>{{ turno.hora_inicio }} - {{ turno.hora_fin }}</td>
              <td>{{ turno.motivo || 'Sin motivo' }}</td>
              <td *ngIf="esAdmin">{{ turno.user_name }}</td>
              <td>
                <span [ngClass]="{
                  'badge bg-secondary': turno.estado === 'Pendiente',
                  'badge bg-success': turno.estado === 'Confirmado',
                  'badge bg-danger': turno.estado === 'Cancelado'
                }">{{ turno.estado }}</span>
              </td>
              <td>
                <ng-container *ngIf="esAdmin; else soloCancelar">
                  <select [(ngModel)]="turno.estado" (change)="cambiarEstado(turno)" class="form-select form-select-sm w-auto d-inline-block me-2">
                    <option value="Pendiente">Pendiente</option>
                    <option value="Confirmado">Confirmado</option>
                    <option value="Cancelado">Cancelado</option>
                  </select>
                </ng-container>
                <ng-template #soloCancelar></ng-template>
                <button class="btn btn-danger btn-sm" (click)="cancelarTurno(turno.id)">Cancelar</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>